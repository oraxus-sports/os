# Docker Compose for All Microfrontends
# This is an example for local testing of production builds

version: '3.8'

services:
  components:
    image: nginx:alpine
    container_name: mfe-components
    ports:
      - "3001:80"
    volumes:
      - ./components/dist:/usr/share/nginx/html
      - ./deployment-examples/nginx-docker-components.conf:/etc/nginx/conf.d/default.conf
    networks:
      - mfe-network

  auth:
    image: nginx:alpine
    container_name: mfe-auth
    ports:
      - "3002:80"
    volumes:
      - ./auth/dist:/usr/share/nginx/html
      - ./deployment-examples/nginx-docker-auth.conf:/etc/nginx/conf.d/default.conf
    networks:
      - mfe-network

  platform:
    image: nginx:alpine
    container_name: mfe-platform
    ports:
      - "3000:80"
    volumes:
      - ./platform/dist:/usr/share/nginx/html
      - ./deployment-examples/nginx-docker-platform.conf:/etc/nginx/conf.d/default.conf
    networks:
      - mfe-network
    depends_on:
      - components
      - auth

networks:
  mfe-network:
    driver: bridge

# Usage:
# 1. Build all apps: npm run build:all
# 2. Start containers: docker-compose -f deployment-examples/docker-compose.yml up
# 3. Access at: http://localhost:3000
